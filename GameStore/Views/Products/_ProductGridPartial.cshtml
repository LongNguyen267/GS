@* 1. QUAN TRỌNG: Phải thêm dòng này để dùng được hàm tạo Slug *@
@using GameStore.Helpers

@model IEnumerable<GameStore.Models.Product>

<div class="product-grid-display">
    @foreach (var product in Model)
    {
        <div class="product-card">
            @* 2. SỬA LINK ẢNH: Dùng href thủ công chuẩn SEO *@
            <a href="/san-pham/@SlugHelper.GenerateSlug(product.Name)-@product.Id" class="product-image-link">

                @if (!string.IsNullOrEmpty(product.Status) && product.Status.Equals("Sale", StringComparison.OrdinalIgnoreCase))
                {
                    <span class="product-tag tag-sale">Giảm giá</span>
                }

                @* Thêm loading="lazy" để tối ưu tốc độ tải trang cho SEO *@
                <img src="@Url.Content(product.ImageUrl ?? "~/image/default-product.png")" alt="@product.Name" loading="lazy">
            </a>

            <div class="product-card-content">
                @* 3. SỬA LINK TIÊU ĐỀ: Cũng dùng href thủ công chuẩn SEO *@
                <h3>
                    <a href="/san-pham/@SlugHelper.GenerateSlug(product.Name)-@product.Id">
                        @product.Name
                    </a>
                </h3>

                <div class="price">@product.Price.ToString("N0")đ</div>

                @* Giữ nguyên logic ẩn nút giỏ hàng ở trang chủ *@
                @if (ViewContext.RouteData.Values["controller"]?.ToString() != "Home")
                {
                    <button type="button" class="add-cart-btn" data-product-id="@product.Id">
                        <i class="fas fa-shopping-cart"></i> Thêm vào giỏ
                    </button>
                }
            </div>
        </div>
    }
</div>